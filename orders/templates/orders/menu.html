{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="banner">
    <h1>Triton Pub Menu</h1>
    <a href="{% url 'view_cart' %}" class="button">View Cart</a>
</div>

<div id="success-msg" class="success-msg" style="display:none; background-color: #28a745; color: white; padding: 10px; margin: 15px auto; border-radius: 6px; max-width: 300px;">Item added to cart!</div>

<div class="menu-container">
    {% for meal in meals %}
    <form action="{% url 'add_to_cart' meal.id %}" method="POST" onsubmit="showSuccessMessage()">
        {% csrf_token %}
        <div class="menu-item">
            {% if meal.image %}
                <img src="{{ meal.image.url }}" alt="{{ meal.name }}">
            {% else %}
                <p>No Image Available</p>
            {% endif %}
            <h3>{{ meal.name }}</h3>
            <p class="price">${{ meal.price }}</p>
            <p>Category: {{ meal.category }}</p>
            <p>Meal Swipe Eligible: {% if meal.mealSwipe %}âœ…{% else %}-{% endif %}</p>

            <label for="side">Choose a side:</label><br>
            <select name="side" required>
                <option value="">-- Select Side --</option>
                <option value="fries">Fries</option>
                <option value="sweet_potato_fries">Sweet Potato Fries</option>
                <option value="chips">Chips</option>
                <option value="fruit">Fruit</option>
            </select>

            <label for="quantity">Quantity:</label><br>
            <input type="number" name="quantity" value="1" min="1" required>

            <label for="special_request">Special Request:</label><br>
            <input type="text" name="special_request" placeholder="e.g. No tomatoes, extra cheese">

            <button type="submit">Add to Cart</button>
        </div>
    </form>
    {% endfor %}
</div>

<a href="{% url 'home' %}" class="button">Home</a>
<a href="{% url 'view_cart' %}" class="button">View Cart</a>

<script>
    function showSuccessMessage() {
        const msg = document.getElementById("success-msg");
        msg.style.display = "block";
        setTimeout(() => { msg.style.display = "none"; }, 2000);
    }
</script>
{% endblock %}